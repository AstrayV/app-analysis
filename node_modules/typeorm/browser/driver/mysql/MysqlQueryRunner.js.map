{"version":3,"sources":["../browser/src/driver/mysql/MysqlQueryRunner.ts"],"names":[],"mappings":"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","file":"MysqlQueryRunner.js","sourcesContent":["import {QueryRunner} from \"../../query-runner/QueryRunner\";\nimport {ObjectLiteral} from \"../../common/ObjectLiteral\";\nimport {TransactionAlreadyStartedError} from \"../../error/TransactionAlreadyStartedError\";\nimport {TransactionNotStartedError} from \"../../error/TransactionNotStartedError\";\nimport {TableColumn} from \"../../schema-builder/schema/TableColumn\";\nimport {Table} from \"../../schema-builder/schema/Table\";\nimport {TableForeignKey} from \"../../schema-builder/schema/TableForeignKey\";\nimport {TablePrimaryKey} from \"../../schema-builder/schema/TablePrimaryKey\";\nimport {TableIndex} from \"../../schema-builder/schema/TableIndex\";\nimport {QueryRunnerAlreadyReleasedError} from \"../../error/QueryRunnerAlreadyReleasedError\";\nimport {MysqlDriver} from \"./MysqlDriver\";\nimport {Connection} from \"../../connection/Connection\";\nimport {ReadStream} from \"../../platform/PlatformTools\";\nimport {EntityManager} from \"../../entity-manager/EntityManager\";\nimport {OrmUtils} from \"../../util/OrmUtils\";\nimport {InsertResult} from \"../InsertResult\";\nimport {QueryFailedError} from \"../../error/QueryFailedError\";\n\n/**\n * Runs queries on a single mysql database connection.\n */\nexport class MysqlQueryRunner implements QueryRunner {\n\n    // -------------------------------------------------------------------------\n    // Public Implemented Properties\n    // -------------------------------------------------------------------------\n\n    /**\n     * Database driver used by connection.\n     */\n    driver: MysqlDriver;\n\n    /**\n     * Connection used by this query runner.\n     */\n    connection: Connection;\n\n    /**\n     * Isolated entity manager working only with current query runner.\n     */\n    manager: EntityManager;\n\n    /**\n     * Indicates if connection for this query runner is released.\n     * Once its released, query runner cannot run queries anymore.\n     */\n    isReleased = false;\n\n    /**\n     * Indicates if transaction is in progress.\n     */\n    isTransactionActive = false;\n\n    /**\n     * Stores temporarily user data.\n     * Useful for sharing data with subscribers.\n     */\n    data = {};\n\n    // -------------------------------------------------------------------------\n    // Protected Properties\n    // -------------------------------------------------------------------------\n\n    /**\n     * Real database connection from a connection pool used to perform queries.\n     */\n    protected databaseConnection: any;\n\n    /**\n     * Promise used to obtain a database connection from a pool for a first time.\n     */\n    protected databaseConnectionPromise: Promise<any>;\n\n    /**\n     * Indicates if special query runner mode in which sql queries won't be executed is enabled.\n     */\n    protected sqlMemoryMode: boolean = false;\n\n    /**\n     * Sql-s stored if \"sql in memory\" mode is enabled.\n     */\n    protected sqlsInMemory: (string|{ up: string, down: string })[] = [];\n\n    /**\n     * Mode in which query runner executes.\n     * Used for replication.\n     * If replication is not setup its value is ignored.\n     */\n    protected mode: \"master\"|\"slave\";\n\n    // -------------------------------------------------------------------------\n    // Constructor\n    // -------------------------------------------------------------------------\n\n    constructor(driver: MysqlDriver, mode: \"master\"|\"slave\" = \"master\") {\n        this.driver = driver;\n        this.connection = driver.connection;\n        this.mode = mode;\n    }\n\n    // -------------------------------------------------------------------------\n    // Public Methods\n    // -------------------------------------------------------------------------\n\n    /**\n     * Creates/uses database connection from the connection pool to perform further operations.\n     * Returns obtained database connection.\n     */\n    connect(): Promise<any> {\n        if (this.databaseConnection)\n            return Promise.resolve(this.databaseConnection);\n\n        if (this.databaseConnectionPromise)\n            return this.databaseConnectionPromise;\n\n        if (this.mode === \"slave\" && this.driver.isReplicated) {\n\n            this.databaseConnectionPromise = this.driver.obtainSlaveConnection().then(connection => {\n                this.databaseConnection = connection;\n                return this.databaseConnection;\n            });\n\n        } else { // master\n            this.databaseConnectionPromise = this.driver.obtainMasterConnection().then(connection => {\n                this.databaseConnection = connection;\n                return this.databaseConnection;\n            });\n        }\n\n        return this.databaseConnectionPromise;\n    }\n\n    /**\n     * Releases used database connection.\n     * You cannot use query runner methods once its released.\n     */\n    release(): Promise<void> {\n        this.isReleased = true;\n        if (this.databaseConnection)\n            this.databaseConnection.release();\n        return Promise.resolve();\n    }\n\n    /**\n     * Starts transaction on the current connection.\n     */\n    async startTransaction(): Promise<void> {\n        if (this.isTransactionActive)\n            throw new TransactionAlreadyStartedError();\n\n        this.isTransactionActive = true;\n        await this.query(\"START TRANSACTION\");\n    }\n\n    /**\n     * Commits transaction.\n     * Error will be thrown if transaction was not started.\n     */\n    async commitTransaction(): Promise<void> {\n        if (!this.isTransactionActive)\n            throw new TransactionNotStartedError();\n\n        await this.query(\"COMMIT\");\n        this.isTransactionActive = false;\n    }\n\n    /**\n     * Rollbacks transaction.\n     * Error will be thrown if transaction was not started.\n     */\n    async rollbackTransaction(): Promise<void> {\n        if (!this.isTransactionActive)\n            throw new TransactionNotStartedError();\n\n        await this.query(\"ROLLBACK\");\n        this.isTransactionActive = false;\n    }\n\n    /**\n     * Executes a raw SQL query.\n     */\n    query(query: string, parameters?: any[]): Promise<any> {\n        if (this.isReleased)\n            throw new QueryRunnerAlreadyReleasedError();\n\n        return new Promise(async (ok, fail) => {\n            try {\n                const databaseConnection = await this.connect();\n                this.driver.connection.logger.logQuery(query, parameters, this);\n                const queryStartTime = +new Date();\n                databaseConnection.query(query, parameters, (err: any, result: any) => {\n\n                    // log slow queries if maxQueryExecution time is set\n                    const maxQueryExecutionTime = this.driver.connection.options.maxQueryExecutionTime;\n                    const queryEndTime = +new Date();\n                    const queryExecutionTime = queryEndTime - queryStartTime;\n                    if (maxQueryExecutionTime && queryExecutionTime > maxQueryExecutionTime)\n                        this.driver.connection.logger.logQuerySlow(queryExecutionTime, query, parameters, this);\n\n                    if (err) {\n                        this.driver.connection.logger.logQueryError(err, query, parameters, this);\n                        return fail(new QueryFailedError(query, parameters, err));\n                    }\n\n                    ok(result);\n                });\n\n            } catch (err) {\n                fail(err);\n            }\n        });\n    }\n\n    /**\n     * Returns raw data stream.\n     */\n    stream(query: string, parameters?: any[], onEnd?: Function, onError?: Function): Promise<ReadStream> {\n        if (this.isReleased)\n            throw new QueryRunnerAlreadyReleasedError();\n\n        return new Promise(async (ok, fail) => {\n            try {\n                const databaseConnection = await this.connect();\n                this.driver.connection.logger.logQuery(query, parameters, this);\n                const stream = databaseConnection.query(query, parameters);\n                if (onEnd) stream.on(\"end\", onEnd);\n                if (onError) stream.on(\"error\", onError);\n                ok(stream);\n\n            } catch (err) {\n                fail(err);\n            }\n        });\n    }\n\n    /**\n     * Insert a new row with given values into the given table.\n     * Returns value of the generated column if given and generate column exist in the table.\n     */\n    async insert(tablePath: string, keyValues: ObjectLiteral): Promise<InsertResult> {\n        const keys = Object.keys(keyValues);\n        const columns = keys.map(key => `\\`${key}\\``).join(\", \");\n        const values = keys.map(key => \"?\").join(\",\");\n        const parameters = keys.map(key => keyValues[key]);\n        const generatedColumns = this.connection.hasMetadata(tablePath) ? this.connection.getMetadata(tablePath).generatedColumns : [];\n        const sql = `INSERT INTO \\`${this.escapeTablePath(tablePath)}\\`(${columns}) VALUES (${values})`;\n        const result = await this.query(sql, parameters);\n\n        const generatedMap = generatedColumns.reduce((map, generatedColumn) => {\n            const value = generatedColumn.isPrimary && result.insertId ? result.insertId : keyValues[generatedColumn.databaseName];\n            if (!value) return map;\n            return OrmUtils.mergeDeep(map, generatedColumn.createValueMap(value));\n        }, {} as ObjectLiteral);\n\n        return {\n            result: result,\n            generatedMap: Object.keys(generatedMap).length > 0 ? generatedMap : undefined\n        };\n    }\n\n    /**\n     * Updates rows that match given conditions in the given table.\n     */\n    async update(tablePath: string, valuesMap: ObjectLiteral, conditions: ObjectLiteral): Promise<void> {\n        const updateValues = this.parametrize(valuesMap).join(\", \");\n        const conditionString = this.parametrize(conditions).join(\" AND \");\n        const sql = `UPDATE \\`${this.escapeTablePath(tablePath)}\\` SET ${updateValues} ${conditionString ? (\" WHERE \" + conditionString) : \"\"}`;\n        const conditionParams = Object.keys(conditions).map(key => conditions[key]);\n        const updateParams = Object.keys(valuesMap).map(key => valuesMap[key]);\n        const allParameters = updateParams.concat(conditionParams);\n        await this.query(sql, allParameters);\n    }\n\n    /**\n     * Deletes from the given table by a given conditions.\n     */\n    async delete(tablePath: string, conditions: ObjectLiteral|string, maybeParameters?: any[]): Promise<void> {\n        const conditionString = typeof conditions === \"string\" ? conditions : this.parametrize(conditions).join(\" AND \");\n        const parameters = conditions instanceof Object ? Object.keys(conditions).map(key => (conditions as ObjectLiteral)[key]) : maybeParameters;\n\n        const sql = `DELETE FROM \\`${this.escapeTablePath(tablePath)}\\` WHERE ${conditionString}`;\n        await this.query(sql, parameters);\n    }\n\n    /**\n     * Inserts rows into the closure table.\n     */\n    async insertIntoClosureTable(tablePath: string, newEntityId: any, parentId: any, hasLevel: boolean): Promise<number> {\n        // todo: escape column names as well\n        if (hasLevel) {\n            await this.query(\n                `INSERT INTO \\`${this.escapeTablePath(tablePath)}\\`(\\`ancestor\\`, \\`descendant\\`, \\`level\\`) ` +\n                `SELECT \\`ancestor\\`, ${newEntityId}, \\`level\\` + 1 FROM \\`${this.escapeTablePath(tablePath)}\\` WHERE \\`descendant\\` = ${parentId} ` +\n                `UNION ALL SELECT ${newEntityId}, ${newEntityId}, 1`\n            );\n        } else {\n            await this.query(\n                `INSERT INTO \\`${this.escapeTablePath(tablePath)}\\`(\\`ancestor\\`, \\`descendant\\`) ` +\n                `SELECT \\`ancestor\\`, ${newEntityId} FROM \\`${this.escapeTablePath(tablePath)}\\` WHERE \\`descendant\\` = ${parentId} ` +\n                `UNION ALL SELECT ${newEntityId}, ${newEntityId}`\n            );\n        }\n        if (hasLevel) {\n            const results: ObjectLiteral[] = await this.query(`SELECT MAX(\\`level\\`) as \\`level\\` FROM \\`${this.escapeTablePath(tablePath)}\\` WHERE \\`descendant\\` = ${parentId}`);\n            return results && results[0] && results[0][\"level\"] ? parseInt(results[0][\"level\"]) + 1 : 1;\n        } else {\n            return -1;\n        }\n    }\n\n    /**\n     * Loads given table's data from the database.\n     */\n    async getTable(tableName: string): Promise<Table|undefined> {\n        const tables = await this.getTables([tableName]);\n        return tables.length > 0 ? tables[0] : undefined;\n    }\n\n    /**\n     * Loads all tables (with given names) from the database and creates a Table from them.\n     */\n    async getTables(tablePaths: string[]): Promise<Table[]> {\n        if (this.sqlMemoryMode)\n            throw new Error(`Loading table is not supported in sql memory mode`);\n\n        // if no tables given then no need to proceed\n        if (!tablePaths || !tablePaths.length)\n            return [];\n\n        const tableNames = tablePaths.map(tablePath => {\n            return tablePath.indexOf(\".\") === -1 ? tablePath : tablePath.split(\".\")[1];\n        });\n        const dbNames = tablePaths\n            .filter(tablePath => tablePath.indexOf(\".\") !== -1)\n            .map(tablePath => tablePath.split(\".\")[0]);\n        if (this.driver.database && !dbNames.find(dbName => dbName === this.driver.database))\n            dbNames.push(this.driver.database);\n\n        // load tables, columns, indices and foreign keys\n        const databaseNamesString = dbNames.map(dbName => `'${dbName}'`).join(\", \");\n        const tableNamesString = tableNames.map(tableName => `'${tableName}'`).join(\", \");\n        const tablesSql      = `SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA IN (${databaseNamesString}) AND TABLE_NAME IN (${tableNamesString})`; // todo(dima): fix, remove IN, apply AND and OR like in Mssql\n        const columnsSql     = `SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA IN (${databaseNamesString})`;\n        const indicesSql     = `SELECT * FROM INFORMATION_SCHEMA.STATISTICS WHERE TABLE_SCHEMA IN (${databaseNamesString}) AND INDEX_NAME != 'PRIMARY' ORDER BY SEQ_IN_INDEX`;\n        const foreignKeysSql = `SELECT * FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE WHERE TABLE_SCHEMA IN (${databaseNamesString}) AND REFERENCED_COLUMN_NAME IS NOT NULL`;\n        const [dbTables, dbColumns, dbIndices, dbForeignKeys]: ObjectLiteral[][] = await Promise.all([\n            this.query(tablesSql),\n            this.query(columnsSql),\n            this.query(indicesSql),\n            this.query(foreignKeysSql)\n        ]);\n\n        // if tables were not found in the db, no need to proceed\n        if (!dbTables.length)\n            return [];\n\n        const isMariaDb = this.driver.options.type === \"mariadb\";\n\n        // create tables for loaded tables\n        return Promise.all(dbTables.map(async dbTable => {\n            const table = new Table(dbTable[\"TABLE_NAME\"]);\n            table.database = dbTable[\"TABLE_SCHEMA\"];\n            const primaryKeys: ObjectLiteral[] = await this.query(`SHOW INDEX FROM \\`${dbTable[\"TABLE_SCHEMA\"]}\\`.\\`${dbTable[\"TABLE_NAME\"]}\\` WHERE Key_name = 'PRIMARY'`);\n\n            // create columns from the loaded columns\n            table.columns = dbColumns\n                .filter(dbColumn => dbColumn[\"TABLE_NAME\"] === table.name)\n                .map(dbColumn => {\n                    const tableColumn = new TableColumn();\n                    tableColumn.name = dbColumn[\"COLUMN_NAME\"];\n\n                    const columnType = dbColumn[\"COLUMN_TYPE\"].toLowerCase();\n                    const endIndex = columnType.indexOf(\"(\");\n                    tableColumn.type = endIndex !== -1 ? columnType.substring(0, endIndex) : columnType;\n\n                    if (dbColumn[\"COLUMN_DEFAULT\"] === null || dbColumn[\"COLUMN_DEFAULT\"] === undefined \n                        || (isMariaDb && dbColumn[\"COLUMN_DEFAULT\"] === \"NULL\")) {\n\n                        tableColumn.default = undefined;\n                    \n                    } else {\n                        tableColumn.default = dbColumn[\"COLUMN_DEFAULT\"];\n                    }\n\n                    tableColumn.isNullable = dbColumn[\"IS_NULLABLE\"] === \"YES\";\n                    tableColumn.isPrimary = dbColumn[\"COLUMN_KEY\"].indexOf(\"PRI\") !== -1;\n                    tableColumn.isUnique = dbColumn[\"COLUMN_KEY\"].indexOf(\"UNI\") !== -1;\n                    tableColumn.isGenerated = dbColumn[\"EXTRA\"].indexOf(\"auto_increment\") !== -1;\n                    tableColumn.comment = dbColumn[\"COLUMN_COMMENT\"];\n                    tableColumn.precision = dbColumn[\"NUMERIC_PRECISION\"];\n                    tableColumn.scale = dbColumn[\"NUMERIC_SCALE\"];\n                    tableColumn.charset = dbColumn[\"CHARACTER_SET_NAME\"];\n                    tableColumn.collation = dbColumn[\"COLLATION_NAME\"];\n\n                    if (tableColumn.type === \"int\" || tableColumn.type === \"tinyint\"\n                        ||  tableColumn.type === \"smallint\" || tableColumn.type === \"mediumint\"\n                        || tableColumn.type === \"bigint\" || tableColumn.type === \"year\") {\n\n                        const length = columnType.substring(columnType.indexOf(\"(\") + 1, columnType.indexOf(\")\"));\n                        tableColumn.length = length ? length.toString() : \"\";\n\n                    } else {\n                        tableColumn.length = dbColumn[\"CHARACTER_MAXIMUM_LENGTH\"] ? dbColumn[\"CHARACTER_MAXIMUM_LENGTH\"].toString() : \"\";\n                    }\n\n                    if (tableColumn.type === \"enum\") {\n                        const colType = dbColumn[\"COLUMN_TYPE\"];\n                        const items = colType.substring(colType.indexOf(\"(\") + 1, colType.indexOf(\")\")).split(\",\");\n                        tableColumn.enum = (items as string[]).map(item => {\n                            return item.substring(1, item.length - 1);\n                        });\n                    }\n\n                    if (tableColumn.type === \"datetime\" || tableColumn.type === \"time\" || tableColumn.type === \"timestamp\") {\n                        tableColumn.precision = dbColumn[\"DATETIME_PRECISION\"];\n                    }\n\n                    return tableColumn;\n                });\n\n            // create primary keys\n            table.primaryKeys = primaryKeys.map(primaryKey => {\n                return new TablePrimaryKey(primaryKey[\"Key_name\"], primaryKey[\"Column_name\"]);\n            });\n\n            // create foreign key schemas from the loaded indices\n            table.foreignKeys = dbForeignKeys\n                .filter(dbForeignKey => dbForeignKey[\"TABLE_NAME\"] === table.name)\n                .map(dbForeignKey => new TableForeignKey(dbForeignKey[\"CONSTRAINT_NAME\"], [], [], \"\", \"\")); // todo: fix missing params\n\n            // create index schemas from the loaded indices\n            table.indices = dbIndices\n                .filter(dbIndex => {\n                    return dbIndex[\"TABLE_NAME\"] === table.name &&\n                        (!table.foreignKeys.find(foreignKey => foreignKey.name === dbIndex[\"INDEX_NAME\"])) &&\n                        (!table.primaryKeys.find(primaryKey => primaryKey.name === dbIndex[\"INDEX_NAME\"]));\n                })\n                .map(dbIndex => dbIndex[\"INDEX_NAME\"])\n                .filter((value, index, self) => self.indexOf(value) === index) // unqiue\n                .map(dbIndexName => {\n                    const currentDbIndices = dbIndices.filter(dbIndex => dbIndex[\"TABLE_NAME\"] === table.name && dbIndex[\"INDEX_NAME\"] === dbIndexName);\n                    const columnNames = currentDbIndices.map(dbIndex => dbIndex[\"COLUMN_NAME\"]);\n\n                    // find a special index - unique index and\n                    if (currentDbIndices.length === 1 && currentDbIndices[0][\"NON_UNIQUE\"] === 0) {\n                        const column = table.columns.find(column => column.name === currentDbIndices[0][\"INDEX_NAME\"] && column.name === currentDbIndices[0][\"COLUMN_NAME\"]);\n                        if (column) {\n                            column.isUnique = true;\n                            return;\n                        }\n                    }\n\n                    return new TableIndex(dbTable[\"TABLE_NAME\"], dbIndexName, columnNames, currentDbIndices[0][\"NON_UNIQUE\"] === 0);\n                })\n                .filter(index => !!index) as TableIndex[]; // remove empty returns\n\n            return table;\n        }));\n    }\n\n    /**\n     * Checks if database with the given name exist.\n     */\n    async hasDatabase(database: string): Promise<boolean> {\n        const result = await this.query(`SELECT * FROM INFORMATION_SCHEMA.SCHEMATA WHERE SCHEMA_NAME = '${database}'`);\n        return result.length ? true : false;\n    }\n\n    /**\n     * Checks if table with the given name exist in the database.\n     */\n    async hasTable(tableOrPath: Table|string): Promise<boolean> {\n        const parsedTablePath = this.parseTablePath(tableOrPath);\n        const sql = `SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = '${parsedTablePath.database}' AND TABLE_NAME = '${parsedTablePath.tableName}'`;\n        const result = await this.query(sql);\n        return result.length ? true : false;\n    }\n\n    /**\n     * Checks if column with the given name exist in the given table.\n     */\n    async hasColumn(tableOrPath: Table|string, column: TableColumn|string): Promise<boolean> {\n        const parsedTablePath = this.parseTablePath(tableOrPath);\n        const columnName = column instanceof TableColumn ? column.name : column;\n        const sql = `SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = '${parsedTablePath.database}' AND TABLE_NAME = '${parsedTablePath.tableName}' AND COLUMN_NAME = '${columnName}'`;\n        const result = await this.query(sql);\n        return result.length ? true : false;\n    }\n\n    /**\n     * Creates a database if it's not created.\n     */\n    createDatabase(database: string): Promise<void[]> {\n        return this.query(`CREATE DATABASE IF NOT EXISTS ${database}`); // todo(dima): IT SHOULD NOT EXECUTE \"IF NOT EXIST\" if user already has a database (privileges issue)\n    }\n\n    /**\n     * Creates a schema if it's not created.\n     */\n    createSchema(schemas: string[]): Promise<void[]> {\n        return Promise.resolve([]);\n    }\n\n    /**\n     * Creates a new table from the given table and column inside it.\n     */\n    async createTable(table: Table): Promise<void> {\n        const columnDefinitions = table.columns.map(column => this.buildCreateColumnSql(column, false)).join(\", \");\n        let sql = `CREATE TABLE \\`${this.escapeTablePath(table)}\\` (${columnDefinitions}`;\n        const primaryKeyColumns = table.columns.filter(column => column.isPrimary && !column.isGenerated);\n        if (primaryKeyColumns.length > 0)\n            sql += `, PRIMARY KEY(${primaryKeyColumns.map(column => `\\`${column.name}\\``).join(\", \")})`;\n        sql += `) ENGINE=${table.engine || \"InnoDB\"}`;\n\n        const revertSql = `DROP TABLE \\`${this.escapeTablePath(table)}\\``;\n        return this.schemaQuery(sql, revertSql);\n    }\n\n    /**\n     * Drop the table.\n     */\n    async dropTable(tableOrPath: Table|string): Promise<void> {\n        const sql = `DROP TABLE \\`${this.escapeTablePath(tableOrPath)}\\``;\n        return this.query(sql);\n    }\n\n    /**\n     * Creates a new column from the column in the table.\n     */\n    async addColumn(tableOrPath: Table|string, column: TableColumn): Promise<void> {\n        const sql = `ALTER TABLE \\`${this.escapeTablePath(tableOrPath)}\\` ADD ${this.buildCreateColumnSql(column, false)}`;\n        const revertSql = `ALTER TABLE \\`${this.escapeTablePath(tableOrPath)}\\` DROP \\`${column.name}\\``;\n        return this.schemaQuery(sql, revertSql);\n    }\n\n    /**\n     * Creates a new columns from the column in the table.\n     */\n    async addColumns(tableOrName: Table|string, columns: TableColumn[]): Promise<void> {\n        const queries = columns.map(column => this.addColumn(tableOrName as any, column));\n        await Promise.all(queries);\n    }\n\n    /**\n     * Renames column in the given table.\n     */\n    async renameColumn(tableOrName: Table|string, oldTableColumnOrName: TableColumn|string, newTableColumnOrName: TableColumn|string): Promise<void> {\n\n        let table: Table|undefined = undefined;\n        if (tableOrName instanceof Table) {\n            table = tableOrName;\n        } else {\n            table = await this.getTable(tableOrName); // todo: throw exception, this wont work because of sql memory enabled. remove support by table name\n            if (!table)\n                throw new Error(`Table ${tableOrName} was not found.`);\n        }\n\n        let oldColumn: TableColumn|undefined = undefined;\n        if (oldTableColumnOrName instanceof TableColumn) {\n            oldColumn = oldTableColumnOrName;\n        } else {\n            oldColumn = table.columns.find(column => column.name === oldTableColumnOrName);\n        }\n\n        if (!oldColumn)\n            throw new Error(`Column \"${oldTableColumnOrName}\" was not found in the \"${tableOrName}\" table.`);\n\n        let newColumn: TableColumn|undefined = undefined;\n        if (newTableColumnOrName instanceof TableColumn) {\n            newColumn = newTableColumnOrName;\n        } else {\n            newColumn = oldColumn.clone();\n            newColumn.name = newTableColumnOrName;\n        }\n\n        return this.changeColumn(table, oldColumn, newColumn);\n    }\n\n    /**\n     * Changes a column in the table.\n     */\n    async changeColumn(tableOrName: Table|string, oldTableColumnOrName: TableColumn|string, newColumn: TableColumn): Promise<void> {\n        let table: Table|undefined = undefined;\n        if (tableOrName instanceof Table) {\n            table = tableOrName;\n        } else {\n            table = await this.getTable(tableOrName);\n        }\n\n        if (!table)\n            throw new Error(`Table ${tableOrName} was not found.`);\n\n        let oldColumn: TableColumn|undefined = undefined;\n        if (oldTableColumnOrName instanceof TableColumn) {\n            oldColumn = oldTableColumnOrName;\n        } else {\n            oldColumn = table.columns.find(column => column.name === oldTableColumnOrName);\n        }\n\n        if (!oldColumn)\n            throw new Error(`Column \"${oldTableColumnOrName}\" was not found in the \"${tableOrName}\" table.`);\n\n        if (newColumn.isUnique === false && oldColumn.isUnique === true)\n            await this.query(`ALTER TABLE \\`${this.escapeTablePath(table)}\\` DROP INDEX \\`${oldColumn.name}\\``); // todo: add revert code\n\n        const sql = `ALTER TABLE \\`${this.escapeTablePath(table)}\\` CHANGE \\`${oldColumn.name}\\` ${this.buildCreateColumnSql(newColumn, oldColumn.isPrimary)}`;\n        const revertSql = `ALTER TABLE \\`${this.escapeTablePath(table)}\\` CHANGE \\`${oldColumn.name}\\` ${this.buildCreateColumnSql(oldColumn, oldColumn.isPrimary)}`;\n        return this.schemaQuery(sql, revertSql);\n    }\n\n    /**\n     * Changes a column in the table.\n     */\n    async changeColumns(table: Table, changedColumns: { newColumn: TableColumn, oldColumn: TableColumn }[]): Promise<void> {\n        const updatePromises = changedColumns.map(async changedColumn => {\n            return this.changeColumn(table, changedColumn.oldColumn, changedColumn.newColumn);\n        });\n\n        await Promise.all(updatePromises);\n    }\n\n    /**\n     * Drops column in the table.\n     */\n    async dropColumn(table: Table, column: TableColumn): Promise<void> {\n        const sql = `ALTER TABLE \\`${this.escapeTablePath(table)}\\` DROP \\`${column.name}\\``;\n        const revertSql = `ALTER TABLE \\`${this.escapeTablePath(table)}\\` ADD ${this.buildCreateColumnSql(column, false)}`;\n        return this.schemaQuery(sql, revertSql);\n    }\n\n    /**\n     * Drops the columns in the table.\n     */\n    async dropColumns(table: Table, columns: TableColumn[]): Promise<void> {\n        const dropPromises = columns.map(column => this.dropColumn(table, column));\n        await Promise.all(dropPromises);\n    }\n\n    /**\n     * Updates table's primary keys.\n     */\n    async updatePrimaryKeys(table: Table): Promise<void> {\n        if (!table.hasGeneratedColumn)\n            await this.query(`ALTER TABLE \\`${this.escapeTablePath(table)}\\` DROP PRIMARY KEY`);\n\n        const primaryColumnNames = table.columns\n            .filter(column => column.isPrimary && !column.isGenerated)\n            .map(column => \"`\" + column.name + \"`\");\n        if (primaryColumnNames.length > 0) {\n            const sql = `ALTER TABLE \\`${this.escapeTablePath(table)}\\` ADD PRIMARY KEY (${primaryColumnNames.join(\", \")})`;\n            const revertSql = `ALTER TABLE \\`${this.escapeTablePath(table)}\\` DROP PRIMARY KEY`;\n            return this.schemaQuery(sql, revertSql);\n        }\n    }\n\n    /**\n     * Creates a new foreign key.\n     */\n    async createForeignKey(tableOrPath: Table|string, foreignKey: TableForeignKey): Promise<void> {\n        const columnNames = foreignKey.columnNames.map(column => \"`\" + column + \"`\").join(\", \");\n        const referencedColumnNames = foreignKey.referencedColumnNames.map(column => \"`\" + column + \"`\").join(\",\");\n        let sql = `ALTER TABLE \\`${this.escapeTablePath(tableOrPath)}\\` ADD CONSTRAINT \\`${foreignKey.name}\\` ` +\n            `FOREIGN KEY (${columnNames}) ` +\n            `REFERENCES \\`${foreignKey.referencedTableName}\\`(${referencedColumnNames})`;\n        if (foreignKey.onDelete) sql += \" ON DELETE \" + foreignKey.onDelete;\n        const revertSql = `ALTER TABLE \\`${this.escapeTablePath(tableOrPath)}\\` DROP FOREIGN KEY \\`${foreignKey.name}\\``;\n        return this.schemaQuery(sql, revertSql);\n    }\n\n    /**\n     * Creates a new foreign keys.\n     */\n    async createForeignKeys(tableOrName: Table|string, foreignKeys: TableForeignKey[]): Promise<void> {\n        const promises = foreignKeys.map(foreignKey => this.createForeignKey(tableOrName as any, foreignKey));\n        await Promise.all(promises);\n    }\n\n    /**\n     * Drops a foreign key from the table.\n     */\n    async dropForeignKey(tableOrPath: Table|string, foreignKey: TableForeignKey): Promise<void> {\n        const sql = `ALTER TABLE \\`${this.escapeTablePath(tableOrPath)}\\` DROP FOREIGN KEY \\`${foreignKey.name}\\``;\n\n        const columnNames = foreignKey.columnNames.map(column => \"`\" + column + \"`\").join(\", \");\n        const referencedColumnNames = foreignKey.referencedColumnNames.map(column => \"`\" + column + \"`\").join(\",\");\n        let revertSql = `ALTER TABLE \\`${this.escapeTablePath(tableOrPath)}\\` ADD CONSTRAINT \\`${foreignKey.name}\\` ` +\n            `FOREIGN KEY (${columnNames}) ` +\n            `REFERENCES \\`${foreignKey.referencedTableName}\\`(${referencedColumnNames})`;\n        if (foreignKey.onDelete) revertSql += \" ON DELETE \" + foreignKey.onDelete;\n\n        return this.schemaQuery(sql, revertSql);\n    }\n\n    /**\n     * Drops a foreign keys from the table.\n     */\n    async dropForeignKeys(tableOrName: Table|string, foreignKeys: TableForeignKey[]): Promise<void> {\n        const promises = foreignKeys.map(foreignKey => this.dropForeignKey(tableOrName as any, foreignKey));\n        await Promise.all(promises);\n    }\n\n    /**\n     * Creates a new index.\n     */\n    async createIndex(table: Table|string, index: TableIndex): Promise<void> {\n        const columns = index.columnNames.map(columnName => \"`\" + columnName + \"`\").join(\", \");\n        const sql = `CREATE ${index.isUnique ? \"UNIQUE \" : \"\"}INDEX \\`${index.name}\\` ON \\`${this.escapeTablePath(table)}\\`(${columns})`;\n        const revertSql = `ALTER TABLE \\`${this.escapeTablePath(table)}\\` DROP INDEX \\`${index.name}\\``;\n        await this.schemaQuery(sql, revertSql);\n    }\n\n    /**\n     * Drops an index from the table.\n     */\n    async dropIndex(tableOrPath: Table|string, index: TableIndex|string): Promise<void> {\n        const indexName = index instanceof TableIndex ? index.name : index;\n        const sql = `ALTER TABLE \\`${this.escapeTablePath(tableOrPath)}\\` DROP INDEX \\`${indexName}\\``;\n\n        if (index instanceof TableIndex) {\n            const columns = index.columnNames.map(columnName => \"`\" + columnName + \"`\").join(\", \");\n            const revertSql = `CREATE ${index.isUnique ? \"UNIQUE \" : \"\"}INDEX \\`${index.name}\\` ON \\`${this.escapeTablePath(tableOrPath)}\\`(${columns})`;\n            await this.schemaQuery(sql, revertSql);\n\n        } else {\n            await this.query(sql);\n        }\n    }\n\n    /**\n     * Truncates table.\n     */\n    async truncate(tableOrPath: Table|string): Promise<void> {\n        await this.query(`TRUNCATE TABLE \\`${this.escapeTablePath(tableOrPath)}\\``);\n    }\n\n    /**\n     * Removes all tables from the currently connected database.\n     * Be careful using this method and avoid using it in production or migrations\n     * (because it can clear all your database).\n     */\n    async clearDatabase(tables?: string[], database?: string): Promise<void> {\n        await this.startTransaction();\n        try {\n            const disableForeignKeysCheckQuery = `SET FOREIGN_KEY_CHECKS = 0;`;\n            const dropTablesQuery = `SELECT concat('DROP TABLE IF EXISTS \\`', table_schema, '\\`.\\`', table_name, '\\`;') AS query FROM information_schema.tables WHERE table_schema = '${database}'`;\n            const enableForeignKeysCheckQuery = `SET FOREIGN_KEY_CHECKS = 1;`;\n\n            await this.query(disableForeignKeysCheckQuery);\n            const dropQueries: ObjectLiteral[] = await this.query(dropTablesQuery);\n            await Promise.all(dropQueries.map(query => this.query(query[\"query\"])));\n            await this.query(enableForeignKeysCheckQuery);\n\n            await this.commitTransaction();\n\n        } catch (error) {\n            try { // we throw original error even if rollback thrown an error\n                await this.rollbackTransaction();\n            } catch (rollbackError) { }\n            throw error;\n        }\n    }\n\n    /**\n     * Enables special query runner mode in which sql queries won't be executed,\n     * instead they will be memorized into a special variable inside query runner.\n     * You can get memorized sql using getMemorySql() method.\n     */\n    enableSqlMemory(): void {\n        this.sqlMemoryMode = true;\n    }\n\n    /**\n     * Disables special query runner mode in which sql queries won't be executed\n     * started by calling enableSqlMemory() method.\n     *\n     * Previously memorized sql will be flushed.\n     */\n    disableSqlMemory(): void {\n        this.sqlsInMemory = [];\n        this.sqlMemoryMode = false;\n    }\n\n    /**\n     * Gets sql stored in the memory. Parameters in the sql are already replaced.\n     */\n    getMemorySql(): (string|{ up: string, down: string })[] {\n        return this.sqlsInMemory;\n    }\n\n    // -------------------------------------------------------------------------\n    // Protected Methods\n    // -------------------------------------------------------------------------\n\n    /**\n     * Executes sql used special for schema build.\n     */\n    protected async schemaQuery(upQuery: string, downQuery: string): Promise<void> {\n\n        // if sql-in-memory mode is enabled then simply store sql in memory and return\n        if (this.sqlMemoryMode === true) {\n            this.sqlsInMemory.push({ up: upQuery, down: downQuery });\n            return Promise.resolve() as Promise<any>;\n        }\n\n        await this.query(upQuery);\n    }\n\n    protected parseTablePath(tableOrPath: Table|string) {\n        if (tableOrPath instanceof Table) {\n            return {\n                database: tableOrPath.database || this.driver.database,\n                tableName: tableOrPath.name\n            };\n        } else {\n            return {\n                database: tableOrPath.indexOf(\".\") !== -1 ? tableOrPath.split(\".\")[0] : this.driver.database,\n                tableName: tableOrPath.indexOf(\".\") !== -1 ? tableOrPath.split(\".\")[1] : tableOrPath\n            };\n        }\n    }\n\n    protected escapeTablePath(tableOrPath: Table|string): string {\n        if (tableOrPath instanceof Table)\n            return tableOrPath.database ? `${tableOrPath.database}\\`.\\`${tableOrPath.name}` : `${tableOrPath.name}`;\n\n        return tableOrPath.split(\".\").map(i => `${i}`).join(\"\\`.\\`\");\n    }\n\n    /**\n     * Parametrizes given object of values. Used to create column=value queries.\n     */\n    protected parametrize(objectLiteral: ObjectLiteral): string[] {\n        return Object.keys(objectLiteral).map(key => `\\`${key}\\`=?`);\n    }\n\n    /**\n     * Builds a part of query to create/change a column.\n     */\n    protected buildCreateColumnSql(column: TableColumn, skipPrimary: boolean) {\n        let c = \"`\" + column.name + \"` \" + this.connection.driver.createFullType(column);\n        if (column.enum)\n            c += \"(\" + column.enum.map(value => \"'\" + value + \"'\").join(\", \") +  \")\";\n        if (column.charset)\n            c += \" CHARACTER SET \" + column.charset;\n        if (column.collation)\n            c += \" COLLATE \" + column.collation;\n        if (column.isNullable !== true)\n            c += \" NOT NULL\";\n        if (column.isUnique === true)\n            c += \" UNIQUE\";\n        if (column.isGenerated && column.isPrimary && !skipPrimary)\n            c += \" PRIMARY KEY\";\n        if (column.isGenerated === true && column.generationStrategy === \"increment\") // don't use skipPrimary here since updates can update already exist primary without auto inc.\n            c += \" AUTO_INCREMENT\";\n        if (column.comment)\n            c += \" COMMENT '\" + column.comment + \"'\";\n        if (column.default !== undefined && column.default !== null)\n            c += \" DEFAULT \" + column.default;\n\n        return c;\n    }\n\n}\n"],"sourceRoot":"../.."}